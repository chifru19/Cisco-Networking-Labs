#!/usr/bin/env python3
import subprocess
import platform

def ping_scanner(network_prefix):
    """
    Scans a local network by sending ICMP Echo Requests (pings)
    to identify active hosts.
    """
    print(f"--- Initiating Scan on Network: {network_prefix}.0/24 ---")
    active_hosts = []

    # Determine the ping parameter based on the Operating System
    # -n is for Windows, -c is for Linux/Mac
    param = "-n" if platform.system().lower() == "windows" else "-c"

    # Iterate through the host range (1 to 254)
    for i in range(1, 255):
        ip = f"{network_prefix}.{i}"
        
        # Run the ping command
        # subprocess.run handles the execution and redirects output to 'devnull' 
        # to keep the console clean.
        try:
            command = ["ping", param, "1", "-w", "500", ip]
            result = subprocess.run(command, stdout=subprocess.DEVNULL, stderr=subprocess.DEVNULL)

            if result.returncode == 0:
                print(f"[+] Host Found: {ip}")
                active_hosts.append(ip)
        except KeyboardInterrupt:
            print("\nScan aborted by user.")
            return

    print("\n--- Scan Complete ---")
    print(f"Total Active Devices: {len(active_hosts)}")

if __name__ == "__main__":
    # Example usage: Entering the first three octets of your Packet Tracer network
    target_net = input("Enter the network prefix (e.g., 192.168.0): ")
    ping_scanner(target_net)
